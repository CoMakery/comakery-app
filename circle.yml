machine:
  timezone:
    America/Los_Angeles

dependencies:
  cache_directories:
    - /home/ubuntu/.phantomjs
  pre:
    - nvm install 5
    - nvm alias default 5
    - nvm use default
    - npm i -g truffle@0.3.1
    - npm i -g ethereumjs-testrpc@1.2.1

test:
  pre:
    - testrpc -p 7777:
        background: true
  override:
    - ./bin/rspect --format documentation:
        parallel: true
        files:
          - spec/**/*_spec.rb
    - cd ethereum && truffle test

deployment:
  autodeploy:
    branch: master
    commands:
      - bin/deploy comakery-staging $CIRCLE_SHA1
